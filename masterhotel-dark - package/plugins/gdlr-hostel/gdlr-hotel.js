!function(e){"use strict";window.gdlr_debounce_function=function(e,t,a){var r;return function(){var n=this,i=arguments;r?clearTimeout(r):a&&e.apply(n,i),r=setTimeout(function(){a||e.apply(n,i),r=null},t)}},e.fn.gdlr_datepicker_range=function(){var t=e(this).attr("data-block"),a=e(this).attr("data-dfm")?e(this).attr("data-dfm"):"yy-mm-dd";e(this).datepicker({minDate:0,dateFormat:a,numberOfMonths:[1,2],beforeShowDay:function(a){if(t){var r=JSON.parse(t),n=e.datepicker.formatDate("yy-mm-dd",a);if(r.indexOf(n)>-1)return[!1]}var i=e.datepicker.parseDate("yy-mm-dd",e("#gdlr-check-in").siblings(".gdlr-datepicker-alt").val()),o=e.datepicker.parseDate("yy-mm-dd",e("#gdlr-check-out").siblings(".gdlr-datepicker-alt").val());return[!0,i&&(a.getTime()==i.getTime()||o&&a>=i&&a<=o)?"dp-highlight":""]},onSelect:function(t,a){var r=e.datepicker.parseDate("yy-mm-dd",e("#gdlr-check-in").siblings(".gdlr-datepicker-alt").val()),n=e.datepicker.parseDate("yy-mm-dd",e("#gdlr-check-out").siblings(".gdlr-datepicker-alt").val());!r||n?(e("#gdlr-check-in").datepicker("setDate",t),e("#gdlr-check-out").val(""),e("#gdlr-check-out").siblings(".gdlr-datepicker-alt").val("")):e("#gdlr-check-out").datepicker("setDate",t).trigger("change")},closeText:objectL10n.closeText,currentText:objectL10n.currentText,monthNames:objectL10n.monthNames,monthNamesShort:objectL10n.monthNamesShort,dayNames:objectL10n.dayNames,dayNamesShort:objectL10n.dayNamesShort,dayNamesMin:objectL10n.dayNamesMin,firstDay:objectL10n.firstDay})},e.fn.gdlr_datepicker=function(){e(this).each(function(){var t=e(this).attr("data-block");e(this).datepicker({dateFormat:e(this).attr("data-dfm")?e(this).attr("data-dfm"):"yy-mm-dd",minDate:0,beforeShowDay:function(a){if(t){var r=JSON.parse(t),n=e.datepicker.formatDate("yy-mm-dd",a);return[-1==r.indexOf(n)]}return[!0]},altField:e(this).siblings(".gdlr-datepicker-alt"),altFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,onSelect:function(t,a){e(this).trigger("change"),e("#gdlr-datepicker-range").datepicker("refresh")},closeText:objectL10n.closeText,currentText:objectL10n.currentText,monthNames:objectL10n.monthNames,monthNamesShort:objectL10n.monthNamesShort,dayNames:objectL10n.dayNames,dayNamesShort:objectL10n.dayNamesShort,dayNamesMin:objectL10n.dayNamesMin,firstDay:objectL10n.firstDay});var a=new Date(e(this).val()+"T00:00:00+00:00");a=new Date(a.getTime()+6e4*a.getTimezoneOffset()),e(this).datepicker("setDate",a)});var t=e(this).filter("#gdlr-check-in").siblings(".gdlr-datepicker-alt").val();if(t==e(this).filter("#gdlr-check-out").siblings(".gdlr-datepicker-alt").val()){var a=new Date(t+"T00:00:00Z");a.setDate(a.getDate()+1),e(this).filter("#gdlr-check-out").datepicker("setDate",a)}},e.fn.gdlr_single_booking=function(){var t=e(this);e(this).find(".gdlr-datepicker").gdlr_datepicker(),e(this).on("change","#gdlr-night, #gdlr-check-in",function(){var e=t.find("#gdlr-check-in"),a=t.find("#gdlr-check-out"),r=a.attr("data-min-night");r=r?parseInt(r):1;var n=t.find("#gdlr-night");if(e.val()){var i=e.datepicker("getDate","+1d");i.setDate(i.getDate()+parseInt(n.val()));var o=e.datepicker("getDate","+1d");o.setDate(o.getDate()+r),a.datepicker("option","minDate",o),a.datepicker("setDate",i)}}),e(this).on("change","#gdlr-check-out",function(){var a=t.find("#gdlr-check-in").datepicker("getDate"),r=e(this).datepicker("getDate"),n=Math.round((r-a)/864e5);if(a&&n>0){var i=t.find("#gdlr-night");0==i.children('option[value="'+n+'"]').length&&i.append('<option value="'+n+'" >'+n+"</option>"),e("#gdlr-night").val(n)}}),e(this).on("change","#gdlr-room-number",function(){var a=parseInt(e(this).val()),r=t.find("#gdlr-reservation-people-amount-wrapper"),n=a-r.children().length;if(n>0)for(var i=0;i<n;i++){var o=r.children(":first-child").clone().hide();o.find(".gdlr-reservation-people-title span").html(r.children().length+1),o.appendTo(r).slideDown(200)}else n<0&&r.children().slice(n).slideUp(200,function(){e(this).remove()})}),e(this).submit(function(){if(""==e(this).find("select[name=gdlr-hotel-branches]").val())return e(this).find("#please-select-branches").slideDown(),!1})},e.fn.gdlr_hotel_booking=function(){var t={wrapper:e(this),resv_bar:e(this).find("#gdlr-reservation-bar"),room_form:e(this).find("#gdlr-reservation-bar-room-form"),date_form:e(this).find("#gdlr-reservation-bar-date-form"),summary_form:e(this).find("#gdlr-reservation-bar-summary-form"),service_form:e(this).find("#gdlr-reservation-bar-service-form"),proc_bar:e(this).find("#gdlr-booking-process-bar"),content_area:e(this).find("#gdlr-booking-content-inner")},a=function(){t.resv_bar.on("change","#gdlr-night, #gdlr-check-in",function(){var a=t.resv_bar.find("#gdlr-check-in"),r=t.resv_bar.find("#gdlr-check-out"),n=r.attr("data-min-night");n=n?parseInt(n):1;var i=t.resv_bar.find("#gdlr-night");if(a.val()){var o=a.datepicker("getDate","+1d");o.setDate(o.getDate()+parseInt(i.val()));var s=a.datepicker("getDate","+1d");s.setDate(s.getDate()+n),r.datepicker("option","minDate",s),r.datepicker("setDate",o),e("#gdlr-datepicker-range").datepicker("refresh")}}),t.resv_bar.on("change","#gdlr-check-out",function(){var a=t.resv_bar.find("#gdlr-check-in").datepicker("getDate"),r=e(this).datepicker("getDate"),n=Math.round((r-a)/864e5);if(a&&n>0){var i=t.resv_bar.find("#gdlr-night");0==i.children('option[value="'+n+'"]').length&&i.append('<option value="'+n+'" >'+n+"</option>"),e("#gdlr-night").val(n)}}),t.resv_bar.on("change","#gdlr-room-number",function(){var a=parseInt(e(this).val()),r=t.resv_bar.find("#gdlr-reservation-people-amount-wrapper"),n=a-r.children().length;if(n>0)for(var i=0;i<n;i++){var o=r.children(":first-child").clone().hide();o.find(".gdlr-reservation-people-title span").html(r.children().length+1),o.appendTo(r).slideDown(200)}else n<0&&r.children().slice(n).slideUp(200,function(){e(this).remove()})}),t.resv_bar.on("click","#gdlr-reservation-bar-button",function(){return n.change_state({state:2}),!1}),t.resv_bar.on("change",'#gdlr-check-in, #gdlr-night, #gdlr-check-out, #gdlr-room-number, #gdlr-hotel-branches, select[name="gdlr-adult-number[]"], select[name="gdlr-children-number[]"]',function(){parseInt(t.proc_bar.attr("data-state"))>1&&t.room_form.slideUp(function(){e(this).html("").removeClass("gdlr-active"),n.change_state({state:2})})})},r=function(e){t.proc_bar.attr("data-state",e),t.proc_bar.children('[data-process="'+e+'"]').addClass("gdlr-active").siblings().removeClass("gdlr-active")},n={init:function(){t.wrapper.find(".gdlr-datepicker").gdlr_datepicker(),t.wrapper.find("#gdlr-datepicker-range").gdlr_datepicker_range(),a(),this.room_select(),this.contact_submit()},room_select:function(){t.content_area.on("click",".price-breakdown-close",function(){return e(this).closest(".price-breakdown-wrapper").fadeOut(200),!1}),t.content_area.on("click",".gdlr-price-break-down",function(){e(this).children(".price-breakdown-wrapper").fadeIn(200)}),t.content_area.on("click",".gdlr-room-selection",function(){return e("body").animate({scrollTop:t.proc_bar.offset().top},300),t.room_form.find(".gdlr-active input").val(e(this).attr("data-roomid")),n.change_state({state:2,room_id:e(this).attr("data-roomid")}),!1}),t.content_area.on("click",".gdlr-pagination a",function(){return n.change_state({paged:e(this).attr("data-paged"),state:2}),!1}),t.room_form.on("click",".gdlr-reservation-change-room",function(){return e(this).closest(".gdlr-reservation-room").find("input").val(""),n.change_state({state:2}),!1}),t.summary_form.on("click","#gdlr-edit-booking-button",function(){return t.room_form.find(".gdlr-reservation-room:first-child input").val(""),n.change_state({state:2}),!1}),t.summary_form.on("change",'input[name="pay_deposit"]',function(){return"true"==e(this).val()?(t.summary_form.find(".gdlr-price-deposit-inner-wrapper").slideDown(),t.summary_form.find(".gdlr-price-summary-grand-total").removeClass("gdlr-active"),t.summary_form.find('input[name="pay_deposit"][value="true"]').closest("span").addClass("gdlr-active"),t.summary_form.find('input[name="pay_deposit"][value="false"]').closest("span").removeClass("gdlr-active")):(t.summary_form.find(".gdlr-price-deposit-inner-wrapper").slideUp(),t.summary_form.find(".gdlr-price-summary-grand-total").addClass("gdlr-active"),t.summary_form.find('input[name="pay_deposit"][value="true"]').closest("span").removeClass("gdlr-active"),t.summary_form.find('input[name="pay_deposit"][value="false"]').closest("span").addClass("gdlr-active")),!1})},contact_submit:function(){t.content_area.on("change",".gdlr-room-service-checkbox input",function(){e(this).is(":checked")?e(this).parent("label").addClass("gdlr-active").siblings("input").prop("disabled",!1):e(this).parent("label").removeClass("gdlr-active").siblings("input").prop("disabled",!0)}),t.content_area.on("click",".gdlr-room-selection-next",function(){return n.change_state({state:3,service:e(this).siblings(".gdlr-booking-service-wrapper").children("form")}),!1}),t.content_area.on("click",".gdlr-booking-contact-submit",function(){var a=t.content_area.find('input[name="term-and-agreement"]');return a.length&&!a.is(":checked")?(t.content_area.find(".gdlr-error-message").html(a.attr("data-error")).slideDown(),!1):(e(this).hasClass("gdlr-clicked")||(e(this).addClass("gdlr-clicked"),t.content_area.find(".gdlr-error-message").slideUp(),n.change_state({state:3,contact:e(this).closest("form"),contact_type:"contact"})),!1)}),t.content_area.on("click",".gdlr-booking-payment-submit",function(){var a=t.content_area.find('input[name="term-and-agreement"]');return a.length&&!a.is(":checked")?(t.content_area.find(".gdlr-error-message").html(a.attr("data-error")).slideDown(),!1):(e(this).hasClass("gdlr-clicked")||(e(this).addClass("gdlr-clicked"),t.content_area.find(".gdlr-error-message").slideUp(),n.change_state({state:3,contact:e(this).closest("form"),contact_type:"instant_payment"})),!1)}),t.content_area.on("click",'.gdlr-payment-method input[name="payment-method"]',function(){e(this).parent("label").addClass("gdlr-active").siblings().removeClass("gdlr-active")});var a=e('<span class="gdlr-coupon-loading" ></span>'),r=e('<span class="gdlr-coupon-message" ></span>');t.content_area.on("change input","#gdlr-coupon-id",gdlr_debounce_function(function(){if(!(e(this).val().length<=0)){var n=e(this);n.parent().prepend(a),e.ajax({type:"POST",url:t.wrapper.attr("data-ajax"),data:{action:n.attr("data-action"),data:t.resv_bar.serialize(),coupon_code:n.val()},dataType:"json",error:function(e,t,a){console.log(e,t,a)},success:function(e){a.remove(),void 0!==e.message?(r.hide(),r.html(e.message).insertAfter(n),r.fadeIn()):r.fadeOut()}})}},400))},change_state:function(a){if(""==t.resv_bar.find("select[name=gdlr-hotel-branches]").val())return t.resv_bar.find("#please-select-branches").slideDown(),!1;t.resv_bar.find("#please-select-branches").slideUp(),t.resv_bar.find("#gdlr-reservation-bar-button").slideUp(200,function(){e(this).remove()}),t.content_area.animate({opacity:.2}),t.content_area.parent().addClass("gdlr-loading");var n={action:t.resv_bar.attr("data-action"),data:t.resv_bar.serialize(),state:a.state};a.room_id&&(n.room_id=a.room_id),a.service&&(n.service=a.service.serialize(),n.service||(n.service="service=none")),a.contact&&(n.contact=a.contact.serialize()),a.contact_type&&(n.contact_type=a.contact_type),a.paged&&(n.paged=a.paged),e.ajax({type:"POST",url:t.wrapper.attr("data-ajax"),data:n,dataType:"json",error:function(e,t,a){console.log(e,t,a)},success:function(a){if(a.state){if(r(a.state),a.content){var n=t.content_area.height();t.content_area.html(a.content);var i=t.content_area.height();t.content_area.parent().removeClass("gdlr-loading"),t.content_area.height(n).animate({opacity:1,height:i},function(){e(this).css("height","auto")})}if(a.summary_form)if(t.summary_form.hasClass("gdlr-active")){n=t.summary_form.height();t.summary_form.html(a.summary_form);i=t.summary_form.height();t.summary_form.height(n).animate({height:i},function(){e(this).css("height","auto")}),4==a.state&&e("body").animate({scrollTop:t.proc_bar.offset().top-(n-i)},300)}else t.summary_form.html(a.summary_form).slideDown().addClass("gdlr-active");if(a.service&&t.service_form.html(a.service),2==a.state){if(t.summary_form.slideUp(function(){e(this).removeClass("gdlr-active")}),t.date_form.slideDown(),a.room_form)if(t.room_form.hasClass("gdlr-active")){n=t.room_form.height();t.room_form.html(a.room_form);i=t.room_form.height();t.room_form.height(n).animate({height:i},function(){e(this).css("height","auto")})}else t.room_form.html(a.room_form).slideDown().addClass("gdlr-active")}else if(3==a.state&&(t.room_form.slideUp(function(){e(this).removeClass("gdlr-active")}),t.date_form.slideUp(),a.error_message&&(t.content_area.find(".gdlr-button").removeClass("gdlr-clicked"),t.content_area.find(".gdlr-error-message").html(a.error_message).slideDown(),t.content_area.parent().removeClass("gdlr-loading"),t.content_area.animate({opacity:1})),a.payment&&"paypal"==a.payment)){var o=t.content_area.find("form.gdlr-booking-contact-form");o.attr("method","post"),o.attr("action",a.payment_url),o.append(a.addition_part),o.submit()}}}})}};return n.init(),this},e(document).ready(function(){e("#gdlr-single-booking-content").gdlr_hotel_booking(),e("body.single #gdlr-reservation-bar, #gdlr-hotel-availability").gdlr_single_booking(),e(".gdlr-room-category-item").on("mouseover",".gdlr-room-category-thumbnail",function(){e(this).children("img").transition({scale:1.1,duration:200,queue:!1}),e(this).children(".gdlr-room-category-thumbnail-overlay").animate({opacity:.6},{duration:150,queue:!1}),e(this).children(".gdlr-room-category-thumbnail-overlay-icon").animate({opacity:1},{duration:150,queue:!1})}),e(".gdlr-room-category-item").on("mouseout",".gdlr-room-category-thumbnail",function(){e(this).children("img").transition({scale:1,duration:200,queue:!1}),e(this).children(".gdlr-room-category-thumbnail-overlay").animate({opacity:0},{duration:150,queue:!1}),e(this).children(".gdlr-room-category-thumbnail-overlay-icon").animate({opacity:0},{duration:150,queue:!1})})})}(jQuery);